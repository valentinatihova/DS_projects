# üìä –ë–∞–∑–æ–≤—ã–π SQL

–°–æ–∑–¥–∞–Ω–∞ –ë–î, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ–Ω—á—É—Ä–Ω—ã—Ö —Ñ–æ–Ω–¥–∞—Ö –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö –≤ –∫–æ–º–ø–∞–Ω–∏–∏-—Å—Ç–∞—Ä—Ç–∞–ø—ã. –≠—Ç–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ [Startup Investments](https://www.kaggle.com/datasets/justinas/startup-investments). –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ñ–æ–Ω–¥–∞—Ö –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö –∏ –Ω–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ.

## ER-diagram
<details>
<summary>
–†–∞—Å–∫—Ä—ã—Ç—å
</summary>
	
<kbd><img src="https://user-images.githubusercontent.com/81607668/139528817-09766746-e26b-4aa6-9465-bd5cc58a34cc.png" alt="Image" width="750" height="480"></kbd>
  
`acquisition` - —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–∫—É–ø–∫–∞—Ö –æ–¥–Ω–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π –¥—Ä—É–≥–∏–º–∏. 

<kbd><img width="659" alt="image" src="https://user-images.githubusercontent.com/81607668/139528238-dade7402-2d4e-4a66-911e-ad1bd949f2ed.png"></kbd>

`company` - —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–ø–∞–Ω–∏—è—Ö-—Å—Ç–∞—Ä—Ç–∞–ø–∞—Ö. 

<kbd><img width="531" alt="image" src="https://user-images.githubusercontent.com/81607668/139528127-64ad1eff-abdb-4e3d-add5-47477ee0d84d.png"></kbd>

`education` - —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–≤–Ω–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–æ–º–ø–∞–Ω–∏–π.

<kbd><img width="527" alt="image" src="https://user-images.githubusercontent.com/81607668/139528283-926c7663-bdfb-4649-ab37-8c2ca814f47d.png"></kbd>

`fund` - —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ–Ω—á—É—Ä–Ω—ã—Ö —Ñ–æ–Ω–¥–∞—Ö.

<kbd><img width="330" alt="image" src="https://user-images.githubusercontent.com/81607668/139528155-b1c44957-d369-41af-a9d7-3da3928f0564.png"></kbd>

`funding_round` - —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—É–Ω–¥–∞—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π. 

<kbd><img width="792" alt="image" src="https://user-images.githubusercontent.com/81607668/139528190-361da1c5-6512-4df7-860e-e0fdbd45f097.png"></kbd>

`investment` - —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö –≤–µ–Ω—á—É—Ä–Ω—ã—Ö —Ñ–æ–Ω–¥–æ–≤ –≤ –∫–æ–º–ø–∞–Ω–∏–∏-—Å—Ç–∞—Ä—Ç–∞–ø—ã.

<kbd><img width="427" alt="image" src="https://user-images.githubusercontent.com/81607668/139528173-eb792b62-c98a-47aa-bd80-bfa5c432063b.png"></kbd>

`people` - —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö –∫–æ–º–ø–∞–Ω–∏–π-—Å—Ç–∞—Ä—Ç–∞–ø–æ–≤.

<kbd><img width="427" alt="image" src="https://user-images.githubusercontent.com/81607668/139528173-eb792b62-c98a-47aa-bd80-bfa5c432063b.png"></kbd>

</details>
 
***

### üìå Q1: –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ, —Å–∫–æ–ª—å–∫–æ –∫–æ–º–ø–∞–Ω–∏–π –∑–∞–∫—Ä—ã–ª–æ—Å—å.
```sql
select 
  count(distinct id) 
from 
  company 
where 
  status = 'closed';
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q2: –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –°–®–ê. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã company. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–π –≤ –ø–æ–ª–µ funding_total .
```sql
select 
  funding_total 
from 
  company 
where 
  country_code = 'USA' 
  and category_code = 'news' 
order by 
  funding_total desc;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q3: –ù–∞–π–¥–∏—Ç–µ –æ–±—â—É—é —Å—É–º–º—É —Å–¥–µ–ª–æ–∫ –ø–æ –ø–æ–∫—É–ø–∫–µ –æ–¥–Ω–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π –¥—Ä—É–≥–∏–º–∏ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö. –û—Ç–±–µ—Ä–∏—Ç–µ —Å–¥–µ–ª–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –∑–∞ –Ω–∞–ª–∏—á–Ω—ã–µ —Å 2011 –ø–æ 2013 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ.
```sql
select 
  sum(price_amount) 
from 
  acquisition 
where 
  term_code = 'cash' 
  and extract(
    year 
    from 
      acquired_at
  ) in (2011, 2012, 2013);
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q4: –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –∏–º—è, —Ñ–∞–º–∏–ª–∏—é –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ª—é–¥–µ–π –≤ —Ç–≤–∏—Ç—Ç–µ—Ä–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –Ω–∞ 'Silver'.
```sql
select 
  first_name, 
  last_name, 
  twitter_username 
from 
  people 
where 
  twitter_username like 'Silver%'
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q5: –í—ã–≤–µ–¥–∏—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª—é–¥—è—Ö, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –≤ —Ç–≤–∏—Ç—Ç–µ—Ä–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–¥—Å—Ç—Ä–æ–∫—É 'money', –∞ —Ñ–∞–º–∏–ª–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ 'K'.
```sql
select 
  * 
from 
  people 
where 
  twitter_username like '%money%' 
  and last_name like 'K%'
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q6: –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–µ. –°—Ç—Ä–∞–Ω—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è, –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ –∫–æ–¥—É —Å—Ç—Ä–∞–Ω—ã. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—É–º–º—ã.
```sql
select 
  country_code, 
  sum(funding_total) 
from 
  company 
group by 
  country_code 
order by 
  2 desc;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q7: –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä—É—é –≤–æ–π–¥—ë—Ç –¥–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ä–∞—É–Ω–¥–∞, –∞ —Ç–∞–∫–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—É–º–º—ã –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –≤ —ç—Ç—É –¥–∞—Ç—É.–û—Å—Ç–∞–≤—å—Ç–µ –≤ –∏—Ç–æ–≥–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–ø–∏—Å–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—É–º–º—ã –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –Ω–µ —Ä–∞–≤–Ω–æ –Ω—É–ª—é –∏ –Ω–µ —Ä–∞–≤–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é.
```sql
select 
  funded_at, 
  max(raised_amount), 
  min(raised_amount) 
from 
  funding_round 
group by 
  funded_at 
having 
  min(raised_amount) != 0 
  and min(raised_amount) != max(raised_amount);
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q8: –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏: –î–ª—è —Ñ–æ–Ω–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É—é—Ç –≤ 100 –∏ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–Ω–∏–π, –Ω–∞–∑–Ω–∞—á—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é high_activity. –î–ª—è —Ñ–æ–Ω–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É—é—Ç –≤ 20 –∏ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–Ω–∏–π –¥–æ 100, –Ω–∞–∑–Ω–∞—á—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é middle_activity. –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π —Ñ–æ–Ω–¥–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 20, –Ω–∞–∑–Ω–∞—á—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é low_activity. –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã fund –∏ –Ω–æ–≤–æ–µ –ø–æ–ª–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏.
```sql
select 
  *, 
  case when invested_companies >= 100 then 'high_activity' when invested_companies >= 20 
  and invested_companies < 100 then 'middle_activity' when invested_companies < 20 then 'low_activity' end 
from 
  fund;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q9: –î–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∑–∞–¥–∞–Ω–∏–∏, –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–∫—Ä—É–≥–ª—ë–Ω–Ω–æ–µ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ–Ω–¥ –ø—Ä–∏–Ω–∏–º–∞–ª —É—á–∞—Å—Ç–∏–µ. –í—ã–≤–µ–¥–∏—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Å—Ä–µ–¥–Ω–µ–≥–æ.
```sql
SELECT 
  CASE WHEN invested_companies >= 100 THEN 'high_activity' WHEN invested_companies >= 20 THEN 'middle_activity' ELSE 'low_activity' END AS activity, 
  round(
    avg(investment_rounds), 
    0
  ) 
FROM 
  fund 
group by 
  activity 
order by 
  2;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q10: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ, –≤ –∫–∞–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ñ–æ–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É—é—Ç –≤ —Å—Ç–∞—Ä—Ç–∞–ø—ã. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ –∫–æ–º–ø–∞–Ω–∏–π, –≤ –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ —Ñ–æ–Ω–¥—ã —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Å 2010 –ø–æ 2012 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ. –ò—Å–∫–ª—é—á–∏—Ç–µ —Å—Ç—Ä–∞–Ω—ã —Å —Ñ–æ–Ω–¥–∞–º–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∫–æ–º–ø–∞–Ω–∏–π, –ø–æ–ª—É—á–∏–≤—à–∏—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, —Ä–∞–≤–Ω–æ –Ω—É–ª—é. –í—ã–≥—Ä—É–∑–∏—Ç–µ –¥–µ—Å—è—Ç—å —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞–Ω-–∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–æ–º–ø–∞–Ω–∏–π –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É, –∞ –∑–∞—Ç–µ–º –ø–æ –∫–æ–¥—É —Å—Ç—Ä–∞–Ω—ã –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ.
```sql
select 
  country_code, 
  min(invested_companies), 
  max(invested_companies), 
  avg(invested_companies) 
from 
  fund 
where 
  extract(
    year 
    from 
      founded_at
  ) between 2010 
  and 2012 
group by 
  country_code 
having 
  min(invested_companies) != 0 
order by 
  4 desc, 
  1 
limit 
  10;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q11: –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É—á–µ–±–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –æ–∫–æ–Ω—á–∏–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫, –µ—Å–ª–∏ —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑–≤–µ—Å—Ç–Ω–∞.
```sql
select 
  p.first_name, 
  p.last_name, 
  e.instituition 
from 
  people p 
  left join education e on e.person_id = p.id
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q12: –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–∫–æ–Ω—á–∏–ª–∏ –µ—ë —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏. –í—ã–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ —á–∏—Å–ª–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π. –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ø-5 –∫–æ–º–ø–∞–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤.
```sql
select 
  c.name, 
  count(distinct e.instituition) 
from 
  company c 
  join people p on p.company_id = c.id 
  join education e on e.person_id = p.id 
group by 
  c.name 
order by 
  2 desc 
limit 
  5;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q13: –°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –æ–∫–∞–∑–∞–ª—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º.
```sql
select 
  distinct c.name 
from 
  company c 
  join funding_round f on f.company_id = c.id 
where 
  c.status = 'closed' 
  and f.is_first_round = 1 
  and f.is_last_round = 1
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q14: –°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∫–æ–º–ø–∞–Ω–∏—è—Ö, –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∑–∞–¥–∞–Ω–∏–∏.
```sql
with t0 as (
  select 
    distinct c.id 
  from 
    company c 
    join funding_round f on f.company_id = c.id 
  where 
    c.status = 'closed' 
    and f.is_first_round = 1 
    and f.is_last_round = 1
) 
select 
  distinct p.id 
from 
  t0 
  join people p on t0.id = p.company_id;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q15: –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –∫—É–¥–∞ –≤–æ–π–¥—É—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–¥–∞—á–∏ –∏ —É—á–µ–±–Ω—ã–º –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ –æ–∫–æ–Ω—á–∏–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫.
```sql
WITH t0 AS (
  SELECT 
    DISTINCT c.id 
  FROM 
    company c 
    JOIN funding_round f ON f.company_id = c.id 
  WHERE 
    c.status = 'closed' 
    AND f.is_first_round = 1 
    AND f.is_last_round = 1
) 
SELECT 
  DISTINCT p.id, 
  e.instituition 
FROM 
  t0 
  JOIN people p ON t0.id = p.company_id 
  join education e on p.id = e.person_id
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q16: –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –ü—Ä–∏ –ø–æ–¥—Å—á—ë—Ç–µ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –º–æ–≥–ª–∏ –æ–∫–æ–Ω—á–∏—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –¥–≤–∞–∂–¥—ã.
```sql
WITH t0 AS (
  SELECT 
    DISTINCT c.id 
  FROM 
    company c 
    JOIN funding_round f ON f.company_id = c.id 
  WHERE 
    c.status = 'closed' 
    AND f.is_first_round = 1 
    AND f.is_last_round = 1
) 
SELECT 
  p.id, 
  count(e.instituition) 
FROM 
  t0 
  JOIN people p ON t0.id = p.company_id 
  join education e on p.id = e.person_id 
group by 
  p.id
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q17: –î–æ–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∑–∞–ø—Ä–æ—Å –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π (–≤—Å–µ—Ö, –Ω–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö), –∫–æ—Ç–æ—Ä—ã–µ –æ–∫–æ–Ω—á–∏–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π. –ù—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∑–∞–ø–∏—Å—å, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∑–¥–µ—Å—å –Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è.
```sql
WITH t0 AS (
  SELECT 
    DISTINCT c.id 
  FROM 
    company c 
    JOIN funding_round f ON f.company_id = c.id 
  WHERE 
    c.status = 'closed' 
    AND f.is_first_round = 1 
    AND f.is_last_round = 1
), 
t1 as (
  SELECT 
    p.id, 
    count(e.instituition) cnt 
  FROM 
    t0 
    JOIN people p ON t0.id = p.company_id 
    join education e on p.id = e.person_id 
  group by 
    p.id
) 
select 
  avg(cnt) 
from 
  t1;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q18: –ù–∞–ø–∏—à–∏—Ç–µ –ø–æ—Ö–æ–∂–∏–π –∑–∞–ø—Ä–æ—Å: –≤—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π (–≤—Å–µ—Ö, –Ω–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö), –∫–æ—Ç–æ—Ä—ã–µ –æ–∫–æ–Ω—á–∏–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ Facebook*.
```sql
WITH t0 AS (
  SELECT 
    DISTINCT c.id 
  FROM 
    company c 
  WHERE 
    c.name = 'Facebook'
), 
t1 as (
  SELECT 
    p.id, 
    count(e.instituition) cnt 
  FROM 
    t0 
    JOIN people p ON t0.id = p.company_id 
    join education e on p.id = e.person_id 
  group by 
    p.id
) 
select 
  avg(cnt) 
from 
  t1;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q19: –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∏–∑ –ø–æ–ª–µ–π: name_of_fund ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–æ–Ω–¥–∞; name_of_company ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏; amount ‚Äî —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–∏–≤–ª–µ–∫–ª–∞ –∫–æ–º–ø–∞–Ω–∏—è –≤ —Ä–∞—É–Ω–¥–µ. –í —Ç–∞–±–ª–∏—Ü—É –≤–æ–π–¥—É—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–º–ø–∞–Ω–∏—è—Ö, –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ—Ç–æ—Ä—ã—Ö –±—ã–ª–æ –±–æ–ª—å—à–µ —à–µ—Å—Ç–∏ –≤–∞–∂–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤, –∞ —Ä–∞—É–Ω–¥—ã —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Å 2012 –ø–æ 2013 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ.
```sql
SELECT 
  f.name as name_of_fund, 
  c.name as name_of_company, 
  fr.raised_amount as amount 
FROM 
  fund as f 
  INNER JOIN investment as i ON f.id = i.fund_id 
  INNER JOIN funding_round as fr ON i.funding_round_id = fr.id 
  INNER JOIN company as c ON fr.company_id = c.id 
WHERE 
  c.milestones > 6 
  and EXTRACT(
    YEAR 
    FROM 
      CAST(fr.funded_at as timestamp)
  ) BETWEEN 2012 
  and 2013;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q20: –í—ã–≥—Ä—É–∑–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç —Ç–∞–∫–∏–µ –ø–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏-–ø–æ–∫—É–ø–∞—Ç–µ–ª—è; —Å—É–º–º–∞ —Å–¥–µ–ª–∫–∏; –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä—É—é –∫—É–ø–∏–ª–∏; —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –∫—É–ø–ª–µ–Ω–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é; –¥–æ–ª—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç, –≤–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏ –ø—Ä–µ–≤—ã—Å–∏–ª–∞ —Å—É–º–º—É –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –∫–æ–º–ø–∞–Ω–∏—é –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –æ–∫—Ä—É–≥–ª—ë–Ω–Ω–∞—è –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞. –ù–µ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ —Ç–µ —Å–¥–µ–ª–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é. –ï—Å–ª–∏ —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ –∫–æ–º–ø–∞–Ω–∏—é —Ä–∞–≤–Ω–∞ –Ω—É–ª—é, –∏—Å–∫–ª—é—á–∏—Ç–µ —Ç–∞–∫—É—é –∫–æ–º–ø–∞–Ω–∏—é –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.
```sql
SELECT 
  c.name AS acquiring_company, 
  a.price_amount, 
  c2.name AS acquired_company, 
  c2.funding_total, 
  ROUND(
    a.price_amount / c2.funding_total
  ) AS part 
FROM 
  acquisition AS a 
  JOIN company AS c ON c.id = a.acquiring_company_id 
  JOIN company AS c2 ON c2.id = a.acquired_company_id 
WHERE 
  a.price_amount <> 0 
  AND c2.funding_total <> 0 
ORDER BY 
  a.price_amount DESC, 
  c2.name 
LIMIT 
  10;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q21: –í—ã–≥—Ä—É–∑–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä—É—é –≤–æ–π–¥—É—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–π –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ social, –ø–æ–ª—É—á–∏–≤—à–∏–µ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å 2010 –ø–æ 2013 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –Ω–µ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é. –í—ã–≤–µ–¥–∏—Ç–µ —Ç–∞–∫–∂–µ –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ—Ö–æ–¥–∏–ª —Ä–∞—É–Ω–¥ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è.
```sql
SELECT 
  c.name, 
  EXTRACT(
    Month 
    FROM 
      CAST(fr.funded_at as timestamp)
  ) 
FROM 
  company as c 
  INNER JOIN funding_round as fr ON c.id = fr.company_id 
WHERE 
  c.category_code = 'social' 
  and EXTRACT(
    YEAR 
    FROM 
      CAST(fr.funded_at as timestamp)
  ) BETWEEN 2010 
  and 2013 
  AND fr.raised_amount != 0;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q22: –û—Ç–±–µ—Ä–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Å—è—Ü–∞–º —Å 2010 –ø–æ 2013 –≥–æ–¥, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—É–Ω–¥—ã. –°–≥—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ—Ä—É –º–µ—Å—è—Ü–∞ –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –ø–æ–ª—è: –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Ä–∞—É–Ω–¥—ã; –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–æ–Ω–¥–æ–≤ –∏–∑ –°–®–ê, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ; –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π, –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü; –æ–±—â–∞—è —Å—É–º–º–∞ —Å–¥–µ–ª–æ–∫ –ø–æ –ø–æ–∫—É–ø–∫–∞–º –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ.
```sql
WITH month_fund AS (
  SELECT 
    EXTRACT(
      MONTH 
      FROM 
        fr.funded_at
    ) AS MONTH, 
    COUNT(DISTINCT f.name) AS count_of_fund 
  FROM 
    funding_round AS fr 
    LEFT JOIN investment AS i ON i.funding_round_id = fr.id 
    LEFT JOIN fund AS f ON i.fund_id = f.id 
  WHERE 
    EXTRACT(
      YEAR 
      FROM 
        fr.funded_at
    ) BETWEEN 2010 
    AND 2013 
    AND f.country_code = 'USA' 
  GROUP BY 
    MONTH
), 
month_acquired AS (
  SELECT 
    EXTRACT(
      MONTH 
      FROM 
        acquired_at
    ) AS MONTH, 
    COUNT(acquired_company_id) AS count_of_acquired, 
    SUM(price_amount) AS sum_of_acquired 
  FROM 
    acquisition 
  WHERE 
    EXTRACT(
      YEAR 
      FROM 
        acquired_at
    ) BETWEEN 2010 
    AND 2013 
  GROUP BY 
    MONTH
) 
SELECT 
  month_fund.month, 
  month_fund.count_of_fund, 
  month_acquired.count_of_acquired, 
  month_acquired.sum_of_acquired 
FROM 
  month_fund 
  JOIN month_acquired ON month_fund.month = month_acquired.month;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

### üìå Q23: –°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω—é—é —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –¥–ª—è —Å—Ç—Ä–∞–Ω, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Å—Ç–∞—Ä—Ç–∞–ø—ã, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ 2011, 2012 –∏ 2013 –≥–æ–¥–∞—Ö. –î–∞–Ω–Ω—ã–µ –∑–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ–ª–µ. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∑–∞ 2011 –≥–æ–¥ –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É.
```sql
WITH a as (
  SELECT 
    country_code, 
    AVG(funding_total) as avg_2011 
  FROM 
    company 
  WHERE 
    EXTRACT(
      YEAR 
      FROM 
        CAST(founded_at as timestamp)
    ) = 2011 
  GROUP BY 
    country_code
), 
b as (
  SELECT 
    country_code, 
    AVG(funding_total) as avg_2012 
  FROM 
    company 
  WHERE 
    EXTRACT(
      YEAR 
      FROM 
        CAST(founded_at as timestamp)
    ) = 2012 
  GROUP BY 
    country_code
), 
c as (
  SELECT 
    country_code, 
    AVG(funding_total) as avg_2013 
  FROM 
    company 
  WHERE 
    EXTRACT(
      YEAR 
      FROM 
        CAST(founded_at as timestamp)
    ) = 2013 
  GROUP BY 
    country_code
) 
SELECT 
  a.country_code, 
  a.avg_2011, 
  b.avg_2012, 
  c.avg_2013 
FROM 
  a 
  INNER JOIN b ON a.country_code = b.country_code 
  INNER JOIN c ON a.country_code = c.country_code 
ORDER BY 
  a.avg_2011 DESC;
```

<img width="294" alt="image" src="https://user-images.githubusercontent.com/81607668/171318070-1151876c-31a6-40ea-ab20-4ac26a8d3623.png">

***